@color-white:           rgb(255, 255, 255); // #ffffff
@color-lightest-grey:   rgb(249, 249, 249); // #f9f9f9
@color-button-hover:    rgb(240, 240, 240); // #f0f0f0;
@color-lighter-grey:    rgb(192, 192, 192); // #c0c0c0
@color-grey:            rgb(140, 140, 140); // #8c8c8c
@color-median-grey:     rgb(119, 119, 119); // #777
@color-black:           rgb(70, 66, 61); // #46423d
@color-blue:            rgb(0, 148, 210); // #0094d2
@color-light-blue:      rgb(0, 174, 229); // #00aee5
@color-lighter-blue:    rgb(162, 218, 244); // #a2daf4
@color-lightest-blue:   rgb(231, 244, 252); // #E7F4FC
@color-lightest-red:    rgb(255, 208, 205); // #ffd0cd

@coog-background:       @color-white;

@coog-base-blur:        0px;
@coog-box-opacity:      0.3;
@coog-background-opacity: 1;
@coog-main-opacity:     1;
@coog-header-opacity:   1;
@coog-panel-opacity:    1;
@coog-incremental-opacity: 1;
@coog-incremental-blur: 0px;
@coog-background-image: none;
@coog-background-color: @color-white;

@tree-line-border-top:  0px;

@brand-primary:         @color-blue;
@coog-box-shadow:       0 1px 4px rgba(0, 0, 0, 0.3);
@coog-max-menu-width:   28em;

// header colors for groups
.coog-group-header-colors {
    color:                  @color-black;
    background-color:       @color-lightest-blue;
}

// Simple fields readonly styles
.coog-readonly-field-mixin {
    background-color:     @color-lightest-grey;
    border-top-left-radius:   5px;
    border-top-right-radius:  5px;
}

// XXX2Many Mixin
.coog-xxx2many-mixin {
    padding-bottom:             15px;

    // No padding if the toolbar is disabled
    :has(> div > div.coog-hidden-toolbar) {
        padding:                0px;
    }

    // Remove background if there is no toolbar
    > div.panel:has(> div.panel-body.coog-hidden-toolbar) {
        box-shadow:         none;
        background-color:   transparent;
    }

    > div.panel {
        background-color:       rgba(@coog-background-color, @coog-panel-opacity);
        margin-bottom:          0px;

        > div.panel-heading {
            color:              @color-black;
            background-color:   rgba(@color-lighter-blue, @coog-header-opacity);
            border-radius:      2px;
            border-width:       0px;
            border-left:        unset;
            border-top:         unset;
            border-right:       unset;
            box-shadow:         @coog-box-shadow;
            padding:            0px;
        }

        > div.panel-body {
            background-color:       transparent;

            .panel {
                margin:         0px 15px 0px 15px;
            }

            // Remove padding from panel-body so trees are more compact
            padding:                0px;

            // Hide selection column of non-act window trees
            * > col.selection-state {
                width:              0px;
            }
            * > th.selection-state {
                ::before, ::after {
                    display:              none;
                }
            }

            > div.panel {
                margin:             0px 15px 0px 15px;
                background-color:   rgba(@coog-background-color, @coog-panel-opacity);
            }
        }

        > div.panel-body.coog-hidden-toolbar {
            margin:             0px 0px 0px 0px;
        }

        > div.panel-body.coog-hidden-toolbar:has(> div.screen-container > div.content-box > div > div.treeview),
        > div.panel-body.coog-hidden-toolbar:has(> div.screen-container > div.content-box > div > div.form-item.form-one2many) {
            box-shadow:             0 1px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 5px;
            margin-top: 5px;
        }
    }
}

// Links without a border are not obviously clickable for users
.coog-highlight-link-button {
    box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.4);
}

///////////////////////////////////////////////////////////////////////////////
// Tree views
///////////////////////////////////////////////////////////////////////////////

div.screen-container > div.content-box > div.tree-container {
    height: 100%;
    height: -moz-available;
    height: -webkit-fill-available;
    height: fill-available;
}

div.wizard-form > div.wizard {
    height: 100%;
    height: -moz-available;
    height: -webkit-fill-available;
    height: fill-available;
    overflow-y: auto;
}

// Use variable for border width
.treeview > table.tree > tbody > tr > td {
    border-top-width:   @tree-line-border-top;
}

// Smaller lines in tree views
.treeview > table.tree > tbody > tr > td {
    padding-top:        2px;
    padding-bottom:     2px;
}

// More discrete checkboxes for selection in trees
.treeview > table.tree,table.tree-condensed > thead,tbody > tr > td.selection-state > input {
    & input[type="checkbox"] {
        margin-top:     @tree-line-border-top;
        margin-bottom:  0px;
    }

    & :before {
        border-color:   @color-lightest-blue !important;
    }

    & tr:hover :before {
        border-color:   @color-grey !important;
    }

    & tr.selected,thead :before {
        border-color:   @color-grey !important;
    }
}

// Make tree view headers a little more visible
.treeview > table.tree > thead > tr:first-child th {
    .coog-group-header-colors();
}

// Remove small scrollbar div above list header
div.scrollbar:has(+ div.treeview) {
    display:                none;
}

// Remove horizontal lines for editable trees
.table-bordered > tbody > tr > td
{
    border-top:       none;
    border-bottom:    none;
}

///////////////////////////////////////////////////////////////////////////////
// Top Menu
///////////////////////////////////////////////////////////////////////////////
//      - lighter color
//      - less vertical padding
nav.toolbar.panel-heading {
    .coog-group-header-colors();
    padding:                0px 10px 0px 0px;

    div.container-fluid.navbar-inverse {
        .coog-group-header-colors();
        padding-left:           0px;

        // Main tab menu: highlight tab title to show that it is clicable
        > div.navbar-header {
            background-color:           @color-white;
            :hover, :focus-within {
                background-color:       @color-button-hover;
            }
            margin:                     5px;
            > .navbar-brand.dropdown-toggle {
                height:                 40px;
                padding:                10px;
                border-radius:          5px;
                color:                  @color-black;
                box-shadow:             @coog-box-shadow;
                :hover {
                    color:              @color-black;
                }
                > span.caret {
                    margin-left:        10px;
                    font-size:          50px;
                    padding:            2px 1px;
                }
            }
            > ul:hover {
                background-color:       @color-white;
            }
        }
    }
}

// Global search
#global-search-entry {
    box-shadow: none;
}


// top left menu
.navbar-inverse .navbar-brand, .navbar-inverse .navbar-nav > li > a {
    color: @color-lightest-blue;
    :hover {
        color: @color-white;
    }
}

#tablist {
    > li {
        // limit tab sizes
        max-width:                20em;
        padding-top:              4px;
        > a {
            padding-bottom:       14px;
            padding-top:          13px;
            border-top-left-radius:   3px;
            border-top-right-radius:  3px;
            border-bottom-left-radius: 0px;
            border-bottom-right-radius:0px;
            .coog-group-header-colors();
            :hover {
                color:              @color-median-grey;
            }

            // "Close" buttons on tabs
            > button {
                .coog-group-header-colors();
                color: black;
                border-radius: 3px;
                margin-top: -3px;

                > span {
                    font-size: 33px;
                }
            }
        }
    }

    // other colors for non-focused tabs
    > li:not(.active) {
        > a {
            color:                  @color-median-grey;
            background-color:       @color-lighter-blue;

            > button {
                background-color:   @color-lighter-blue;
                color:              @color-median-grey;
            }
        }
        :hover {
            .coog-group-header-colors();
            > button {
                background-color:   @color-lightest-blue;
            }
        }
    }
}

///////////////////////////////////////////////////////////////////////////////
// Left menu
///////////////////////////////////////////////////////////////////////////////

#menu {
    padding-right: 0px;
    padding-left: 0px;

    * > .table-hover > tbody > tr:hover {
        background-color:   @color-lighter-blue;
    }
}

// Do not use too much space for the menu
@media (min-width: @screen-lg-min) {
    .make-offcanvas(min(calc(25%), @coog-max-menu-width));
    .main-offcanvas {
        width: calc(100% - min(calc(25%), @coog-max-menu-width));
    }
}

///////////////////////////////////////////////////////////////////////////////
// Buttons
///////////////////////////////////////////////////////////////////////////////

// Lighter colors
html[theme="default"] .btn-primary {
    color:                      @color-black;
    background-color:           @color-lightest-blue;

    // Do not invert button icons since we use a lighter style
    .icon {
        filter:                 none;
    }

    &:focus,
    &:hover,
    &:active:hover {
        background-color:       @color-lighter-blue;
    }
}

///////////////////////////////////////////////////////////////////////////////
// Act Window list
///////////////////////////////////////////////////////////////////////////////

// Search pop-up
form.modal-content > div.modal-body > div.screen-container,
// Act window tab
div.tab-form > div.panel-body > div > div.screen-container {
    // highlight filter button
    > form.filter-box > div.row > div > div.input-group > span > button.btn-link {
        .coog-highlight-link-button();
        border-radius: 3px;
        margin-right: 5px
    }
    // Slightly round corner on main list view
    > div.content-box > div > div.treeview {
        border-top-left-radius: 3px;
        border-top-right-radius: 3px;
    }
}

div.tab-pane {
    height: 100%;
    height: -moz-available;          /* WebKit-based browsers will ignore this. */
    height: -webkit-fill-available
}

///////////////////////////////////////////////////////////////////////////////
// Dropdowns
///////////////////////////////////////////////////////////////////////////////
//
// more compact items
ul.dropdown-menu > li > a {
    padding:    2px 8px;
    > div > img {
        margin-right: 2px;
        width: 1.5em;
        height: 1.5em;
    }
}

///////////////////////////////////////////////////////////////////////////////
// One2Many
///////////////////////////////////////////////////////////////////////////////
div.form-item.form-one2many {
    .coog-xxx2many-mixin();
}

ul.list-group.list-form {
    margin-bottom:          0px;

    > li.list-group-item.list-group-item-selected {
        color:                  @color-black;
        // background-color:       rgba(@coog-background-color, @coog-main-opacity);
        background-color:       rgba(@color-lightest-blue, 0.6);
    }
}

///////////////////////////////////////////////////////////////////////////////
// Many2Many
///////////////////////////////////////////////////////////////////////////////
div.form-item.form-many2many {
    .coog-xxx2many-mixin();
}

///////////////////////////////////////////////////////////////////////////////
// Dict fields
///////////////////////////////////////////////////////////////////////////////

div.form-dict {
    margin-bottom:              5px;

    // Apply readonly value of dict field to values
    .readonly {
        input.form-control, select.form-control {
            .coog-readonly-field-mixin();
        }
    }

    // use same style than groups
    > div.form-dict-heading {
        .coog-group-header-colors();
    }

    // more compact design
    > div.form-dict-body {
        padding:                    5px 5px 0px 5px;

        > div.form-dict-container {
            > div.form-group {
                margin-bottom:       5px;

                > div.dict-label {
                    padding-left:    5px;
                    padding-right:   0px;
                }
            }
        }
    }
}
///////////////////////////////////////////////////////////////////////////////
// Groups
///////////////////////////////////////////////////////////////////////////////

// Style group headers as dicts
div.form-item.form-group_:has(> fieldset.form-group_ > legend) {
    padding-bottom:             15px;

    // "legends" are special and default style is weird, transform the style to
    // look like dicts
    > fieldset.form-group_ {
        display: flex;
        flex-direction: column;
        box-shadow:                     @coog-box-shadow;
        margin-bottom:                  10px;

        > div.form-container {
            clear:                      both;
            display:                    grid;
            grid-template-columns:      1fr 1fr;
        }

        > legend {
            float:                      left;
            box-sizing:                 border-box;
            width:                      100%;
            border-top-left-radius:     3px;
            border-top-right-radius:    3px;
            border-bottom-width:        0px;
            .coog-group-header-colors();
            margin-bottom:              5px;
            padding:                    2px 7px 2px 7px;
        }
    }
}

// Style expandable groups as dicts
div.form-group-expandable {
    height:                             min-content;
    > div.panel-heading {
        .coog-group-header-colors();

        > label.panel-title {
            font-size:                  14px;
        }
    }
}

// Remove all padding from groups without a legend
div.form-item.form-group_:not(:has(> fieldset.form-group_ > legend)) {
    padding:                            0px;
}

///////////////////////////////////////////////////////////////////////////////
// Wizards
///////////////////////////////////////////////////////////////////////////////

// Use lighter headers for wizards
div.modal-header {
    border-top-left-radius:     3px;
    border-top-right-radius:    3px;
    .coog-group-header-colors();
}

div.modal-header .close {
    font-size: 21px;
}

div.wizard-dialog {
    // For "small" state views, bump the window width from 600px
    > div.modal-dialog.modal-md {
        width:                  ~"calc(min(100%, 1200px) - 60px)";
        margin:                 30px ~"max(30px, calc((100% - min(100%, 1140px)) / 2))";
    }
    // Slightly highlight non-default buttons
    > div.modal-dialog > div.modal-footer > button.btn-link {
        .coog-highlight-link-button();
    }
}

///////////////////////////////////////////////////////////////////////////////
// Misc fields
///////////////////////////////////////////////////////////////////////////////

div.form-many2one, div.form-selection, div.form-date, div.form-char {
    padding:                0px 10px 0px 0px;

    .readonly {
        .input-group, select.form-control:disabled {
            .coog-readonly-field-mixin();
        }
    }
}

div.form-float {
    padding:                0px 10px 0px 0px;

    .readonly {
        .input-group > input {
            .coog-readonly-field-mixin();
        }
    }
}

// Add a little space on the left of simple inputs
div.form-date > div.input-group > input.form-control.input-date,
div.form-item.form-selection > div.form-selection > select.form-control,
div.form-item.form-char > div.form-char > div.input-group > input.form-control
{
    padding-left:           6px;
}

// Remove padding of numerics if there is a symbol after
div.form-item.form-float:has(+ div.form-item.form-label) {
    div.form-float {
        padding-right:      0px;
    }
}

div.form-selection select.form-control {
    padding:              0px 5px 0px 5px;
}

div.form-text {
    padding:                3px 10px 3px 10px;
    textarea.form-control {
        border: 1px solid rgba(@color-lighter-grey, @coog-box-opacity);
        box-shadow: 0 1px 4px rgba(@color-black,    @coog-box-opacity);
        padding:            5px;
        margin-bottom:      2px;

        &:focus {
            box-shadow: 0 1px 4px rgba(@color-blue, 0.6);
        }
    }
    // highlight readonly text contents
    .readonly {
        textarea.form-control {
            .coog-readonly-field-mixin();
        }
    }
}

// Make selections without any options look readonly
select:empty, select:has(> option[value="null"]):not(:has(> option:not([value="null"]))) {
    .coog-readonly-field-mixin();
    pointer-events:         none;
}

// flatter checkboxes
div.form-boolean > input[type=checkbox].input-checkbox {
    box-shadow:            none;
}

// remove underline from checkboxes
div.form-boolean > input[type=checkbox].input-checkbox.form-control[readonly] {
    border-bottom:     none;
}

// increase minimum width of fields
.form {
    .form-password, .form-float,
    .form-datetime, .form-time, .form-timedelta, .form-selection,
    .form-multiselection, .form-url, .form-email, .form-callto, .form-sip,
    .form-pyson {
        input, select {
            min-width: 17ch;
        }
    }
    .form-char, .form-integer {
        input:not([size]) {
            min-width: 17ch;
        }
        input[size] {
            min-width: unset;
        }
    }
    .form-many2one, .form-one2one, .form-reference, form-binary {
        select {
            min-width: 15ch;
        }
        input {
            min-width: 17ch;
        }
    }
    .form-date {
        input {
            min-width: 17ch;
        }
        div.icon-input > input {
            min-width: unset;
        }
    }
}
///////////////////////////////////////////////////////////////////////////////
// Rule engine
///////////////////////////////////////////////////////////////////////////////

@coog-rule-engine-height:         500px;

div.form-item.form-source > div.form-source {
    // This is the tree view with all the rule engine functions, we want it
    // a little more compact
    > div > div.treeview {
        height:                   calc(@coog-rule-engine-height + 42px);
        padding:                  10px 3px 10px 3px !important;
        box-shadow:               @coog-box-shadow;
        border-radius:            2px;

        > table.tree > tbody > tr > td > td > table > tbody > tr > td {
            span {
                font-size:        10px;
                padding-bottom:   3px;
            }

            > p {
                margin:           1px 1px 2px 0px;
            }
        }
    }
    > div.panel {
        > div.panel-heading {
            background-color:     @color-lighter-blue;
            padding:              5px;
        }
        > div.panel-body {
            padding:              0px 15px 0px 0px;
        }
    }
}

div.readonly div.CodeMirror-sizer {
    background-color: lightgrey;
}

div.CodeMirror {
    height: @coog-rule-engine-height;
}

///////////////////////////////////////////////////////////////////////////////
// Pop up menu
///////////////////////////////////////////////////////////////////////////////
#popup-menu {
    * > li.divider {
        margin-top:         2px;
        margin-bottom:         2px;
    }

    * > li > a:hover {
        background-color:   @color-lightest-blue;
        color:              @color-black;
    }
}

///////////////////////////////////////////////////////////////////////////////
// Fixes
///////////////////////////////////////////////////////////////////////////////

// bottom alignment of menu / main tab ////////////////////////////////////////
#menu {
    padding-bottom: 5px;
    height: calc(100% - 2px) !important;
}
#tabs {
    padding-bottom: 0px;
}

// Remove shadowing of disabled buttons, it looks weird
.btn[disabled] {
    box-shadow: none !important;
}

// Hide line of notebooks with all tabs hidden
ul.nav.nav-tabs:empty {
    border-bottom:    none;
}

// In-tab wizard are not displayed in the right direction
div.wizard-form {
    flex-direction:  column;
}

///////////////////////////////////////////////////////////////////////////////
// Information Messages
///////////////////////////////////////////////////////////////////////////////

div.infobar {
    position:                   sticky;
    top:                        unset;
    text-align:                 left;
    bottom:                     0;
    left:                       10px;
    min-width:                  max-content;
    max-width:                  50%;
    transform:                  unset;
}

///////////////////////////////////////////////////////////////////////////////
// Scrollbars
///////////////////////////////////////////////////////////////////////////////

// Does not work on firefox for now
::-webkit-scrollbar {
    width: 6px;
    height: 6px;
}

/* Track */
::-webkit-scrollbar-track {
    background: var(--lightestgrey);
}

/* Handle */
::-webkit-scrollbar-thumb {
    background: @color-lighter-grey;
    border-radius: 3px;
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
    background: @color-grey;
}

///////////////////////////////////////////////////////////////////////////////
// Spinner for processing
///////////////////////////////////////////////////////////////////////////////
// from https://loading.io/css/
#processing {
    padding-top:   300px;
    padding-bottom: 100%;
    background-color: rgba(@color-black, 0.6);
    cursor: wait;
    .label-info {
        display: inline-block;
        width: 80px;
        height: 80px;
        background: transparent;
    }
    .label-info:after {
        content: " ";
        display: block;
        width: 60px;
        height: 60px;
        // margin: 8px;
        border-radius: 50%;
        border: 6px solid #fff;
        border-color: #fff transparent #fff transparent;
        animation: label-info 1.2s linear infinite;
    }
    @keyframes label-info {
        0% {
            transform: rotate(0deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }
}
